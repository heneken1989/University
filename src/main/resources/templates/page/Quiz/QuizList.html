<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
layout:decorate="~{/layout}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>University Planner - UniHub</title>
<link rel="stylesheet" href="styles.css">
<style type="text/css">

body, h1 {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
}

.container {
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    text-align: center;
}

header h1 {
    color: #333;
    margin-bottom: 10px;
}

.module-count {
    color: #666;
    margin-bottom: 20px;
}

.module-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 20px;
}

.module {
    border-radius: 15px;
    padding: 20px;
    font-size: 14px;
    color: #333;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100px;
}

/* For responsive design */
@media (max-width: 640px) {
    .container {
        margin: 10px;
        padding: 10px;
    }
}

    .content-container {
        display: flex;
        justify-content: space-between;
        gap: 20px;
    }

    .quiz-list-container {
        max-width: 600px;
        padding: 20px;
        text-align: center;
        display: none; /* Initially hidden */
    }

    .quiz-list {
        border-radius: 15px;
        padding: 20px;
        font-size: 14px;
        color: #333;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100px;
        margin-bottom: 20px;
    }
    
        .flex-container {
        display: flex;
        justify-content: space-around;
        align-items: flex-start;
    }

    .container, .quiz-list-container {
        margin: 20px;
        padding: 20px;
    }

    .quiz-list-container {
        background-color: #fff; /* For visibility */
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        border-radius: 15px;
        display: none; /* Initially hidden */
        width: 300px; /* Adjust width as needed */
    }

    .quiz-item {
        background-color: #f9f9f9; /* Light grey background */
        border: 1px solid #ddd; /* Light grey border */
        margin-bottom: 10px; /* Space between items */
        padding: 15px;
        border-radius: 5px; /* Rounded corners for the quiz items */
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Slight shadow for each item */
    }

</style>
</head>
<body layout:fragment="content">
<div class="flex-container">
    <!-- Class List Container -->
    <div class="container">
        <header>
            <h1>LIST CLASS THIS SEMESTER</h1>
            <div class="module-count">88 Modules</div>
        </header>
        <div class="module-grid">
            <!-- Class modules here -->
    <div class="module" th:each="list:${listClass}" th:data-class-id="${list.id}" th:onclick="'showQuizList(\'' + ${list.id} + '\')'">
    <div th:text="${list.classforSubject.Subject.name} + '  ' + ${list.classforSubject.name}"></div>
</div>
        </div>
    </div>

    <!-- Quiz List Container, now to the right of the Class List Container -->
    <div class="quiz-list-container" id="quizListContainer">
        <!-- Quiz list items will be populated here -->
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
// Function to show the quiz list for the selected class
function showQuizList(classId) {
    var xhr = new XMLHttpRequest();
    var url = '/listQuizByClass?classId=' + classId;
    xhr.open('GET', url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            console.log(xhr.responseText);
            var quizzes = JSON.parse(xhr.responseText);

            // Generate the quiz list HTML only after the data has been fetched
            var quizListHtml = quizzes.map(function(quiz) {
                return `
                    <div class="quiz-item">
                        <h3>${quiz.classForSubject.name} - ${quiz.quiz.name}</h3>
                        <p>Quiz details: ${quiz.quiz.details}</p>
                        <button onclick="startQuiz('${quiz.quiz.id}')">Start Quiz</button>
                    </div>
                `;
            }).join('');

            // Update the quiz list container with the fetched quizzes
            var quizListContainer = document.getElementById('quizListContainer');
            quizListContainer.innerHTML = quizListHtml;
            quizListContainer.style.display = 'block'; 
        }
    };
    xhr.send();
}

// Function to prompt the user to start the quiz
function startQuiz(quizId) {
    Swal.fire({
        title: 'Are you ready to start the quiz?',
        text: "Make sure you're in the right place and ready to begin.",
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Start Quiz'
    }).then((result) => {
        if (result.isConfirmed) {
            console.log(quizId);
            window.location.href = '/quiz?quizId=' + quizId;
        }
    });
}
</script>

</body>
</html>